<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Together We Are One</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- Leaflet -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- Supabase -->
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <!-- PNG Export helper -->
  <script src="https://unpkg.com/leaflet-image@0.4.0/leaflet-image.js"></script>

<!-- Open Graph / WhatsApp / Facebook -->
<meta property="og:type" content="website">
<meta property="og:title" content="Together We Are One">
<meta property="og:description" content="A quiet place. You set a light and see that many feel the same.">
<meta property="og:image" content="https://togetherweareone.earth/TogetherWeAreOneEarth.jpeg">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="1200">
<meta property="og:url" content="https://togetherweareone.earth/">

<!-- Twitter (optional, aber gut) -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://togetherweareone.earth/TogetherWeAreOneEarth.jpeg">

  <style>
   :root{
  --bg0:#0c0e13;
  --bg1:#14172a;

  --card: rgba(255,255,255,0.06);
  --card2: rgba(255,255,255,0.08);
  --stroke: rgba(255,255,255,0.10);

  --text: rgba(245,247,250,0.90);
  --ghost: rgba(255,255,255,0.22);
  --warm: rgba(255,214,160,0.92);

  --map-brightness: 0.66;
  --map-contrast: 1.20;
  --map-saturate: 0.0;

  --shade-opacity: 0.88;
  --ocean-tint: rgba(8,12,24,0.34);
}
    html,body { height:100%; }
    body{
      margin:0;
      color: var(--text);
      background:
        radial-gradient(1200px 700px at 50% 12%, rgba(40,60,110,0.35) 0%, rgba(0,0,0,0) 55%),
        radial-gradient(900px 520px at 20% 8%, rgba(130,90,40,0.18) 0%, rgba(0,0,0,0) 55%),
        linear-gradient(180deg, var(--bg1), var(--bg0));
      font-family: ui-sans-serif, system-ui, -apple-system, "SF Pro Display", "Inter", "Segoe UI", Arial, sans-serif;
      overflow-x:hidden;
    }

    .wrap{
      min-height:100%;
      display:grid;
      grid-template-rows:auto auto 1fr auto;
      gap:14px;
      padding:18px 14px;
      box-sizing:border-box;
      max-width:1100px;
      margin:0 auto;
    }

    /* --- Prompter --- */
    .teleprompter{
      padding:18px 18px 14px 18px;
      border-radius:20px;
      background: linear-gradient(180deg, var(--card2), var(--card)), radial-gradient(600px 300px at 50% 0%, var(--accent-soft), transparent);/*background: linear-gradient(180deg, var(--card2), var(--card));*/
      border: 1px solid var(--stroke);
      box-shadow: 0 16px 60px rgba(0,0,0,0.35);
      backdrop-filter: blur(10px);
    }
    .tp-text{
      display: block;
      max-width: 28em;
      margin: 0 auto;

      text-align: center;
      font-size: clamp(18px, 2.5vw, 30px);
      line-height: 1.45;
      padding: 8px 10px 10px 10px;
      overflow-wrap: normal;
      word-break: keep-all;
    }
    .tp-word{
      color: var(--ghost);
      transition: color 160ms ease, filter 160ms ease;
      white-space: normal;
      overflow-wrap: normal;
      word-break: keep-all;
    }
    .tp-space{ white-space: normal;}
    .tp-word.done{
      color: var(--warm);
      filter: drop-shadow(0 0 12px rgba(255,210,140,0.18));
    }
    .tp-word.active{
      color: rgba(255,245,235,0.98);
      filter: drop-shadow(0 0 18px rgba(255,210,140,0.26));
    }

    .tp-meta{
      display:flex; align-items:center; justify-content:center;
      gap:10px; margin-top:8px; user-select:none;
    }
    .tp-btn{
      width:42px; height:42px; border-radius:14px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(255,255,255,0.06);
      color: rgba(255,255,255,0.85);
      cursor:pointer;
      transition: background 140ms ease, transform 140ms ease;
      font-size:18px; font-weight:700;
    }
    .tp-btn:hover{ background: rgba(255,255,255,0.10); transform: translateY(-1px); }

    .tp-progress{
      width: min(520px, 62vw);
      height:8px;
      border-radius:8px;
      overflow:hidden;
      background: rgba(255,255,255,0.10);
      border:1px solid rgba(255,255,255,0.08);
    }
    .tp-progress-bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, rgba(255,220,170,0.65), rgba(255,255,255,0.55));
      transition: width 220ms ease;
    }

    /* --- Map --- */
    .mapWrap{
      position:relative;
      border-radius:20px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.10);
      box-shadow: 0 16px 60px rgba(0,0,0,0.35);
      background:#0a0b10;
    }
    #map{ width:100%; height: min(62vh, 520px); }
    #map, #map *{
  cursor: crosshair !important;   /* oder: default, cellhair, move */
}


    /* On-screen: Graustufe + dunkler */
    .leaflet-tile{
      filter:
        grayscale(1)
        brightness(var(--map-brightness))
        contrast(var(--map-contrast))
        saturate(var(--map-saturate));
    }

    .mapTint{
      pointer-events:none;
      position:absolute; inset:0;
      background: var(--ocean-tint);
      mix-blend-mode: multiply;
      opacity:1;
    }
    .mapShade{
      pointer-events:none;
      position:absolute; inset:0;
      opacity: var(--shade-opacity);
      background:
        radial-gradient(900px 420px at 50% 10%, rgba(0,0,0,0.18), rgba(0,0,0,0.86) 65%),
        radial-gradient(700px 520px at 10% 80%, rgba(0,0,0,0.12), rgba(0,0,0,0.78) 72%),
        linear-gradient(180deg, rgba(0,0,0,0.14), rgba(0,0,0,0.70));
      mix-blend-mode: multiply;
    }

    .hud{
      position:absolute;
      left:12px; top:12px;
      display:flex; gap:10px;
      z-index:500;
      flex-wrap:wrap;
      align-items:center;
    }
    .hud button{
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,0.10);
      background: rgba(0,0,0,0.24);
      color: rgba(255,255,255,0.92);
      cursor:pointer;
      backdrop-filter: blur(10px);
      transition: background 140ms ease, transform 140ms ease;
      font-weight:650;
      letter-spacing:0.2px;
    }
    .hud button:hover{ background: rgba(0,0,0,0.32); transform: translateY(-1px); }

    .hint{ text-align:center; margin:4px 0 0 0; color: rgba(255,255,255,0.60); font-size:14px; }
    .status{ text-align:center; color: rgba(255,255,255,0.70); font-size:13px; margin-top:6px; }

    @media (max-width:600px){
      .wrap{ padding:12px 10px; }
      .teleprompter{ padding:14px 12px 12px 12px; border-radius:18px; }
      .tp-btn{ width:40px; height:40px; border-radius:14px; }
      #map{ height:52vh; }
      
    }
    #langBadge{
  position: fixed;
  left: 10px;
  top: 10px;
  z-index: 9999;
  padding: 6px 8px;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(0,0,0,0.25);
  color: rgba(255,255,255,0.85);
  font: 600 12px/1 ui-sans-serif, system-ui, -apple-system, "Inter", "Segoe UI", Arial, sans-serif;
  letter-spacing: 0.08em;
  backdrop-filter: blur(8px);
}
.share{
  display:flex;
  justify-content:center;
  gap:14px;
  margin:22px 0 8px 0;
  flex-wrap:wrap;
}

.share-btn{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  width:64px;
  padding:10px 6px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.06);
  color: rgba(255,255,255,0.85);
  cursor:pointer;
  backdrop-filter: blur(8px);
  transition: background 140ms ease, transform 140ms ease;
}

.share-btn:hover{
  background: rgba(255,255,255,0.10);
  transform: translateY(-1px);
}

.share-btn .icon{
  font-size:22px;
  line-height:1;
  margin-bottom:6px;
}

.share-btn .label{
  font-size:11px;
  opacity:0.75;
  text-align:center;
  line-height:1.2;
}
.share-btn[data-share="native"]{
  background: rgba(255,255,255,0.10);
  border-color: rgba(255,255,255,0.18);
}
  </style>
</head>

<body>
  <div id="langBadge" aria-label="Language"></div>
  <div class="wrap">

    <div class="teleprompter" aria-label="Text">
      <p class="tp-text" id="tp-text"></p>
      <div class="tp-meta">
        <button class="tp-btn" id="tp-prev" title="ZurÃ¼ck" aria-label="ZurÃ¼ck">â†</button>
        <div class="tp-progress"><div class="tp-progress-bar" id="tp-bar"></div></div>
        <button class="tp-btn" id="tp-next" title="Weiter" aria-label="Weiter">â†’</button>
      </div>
     <div class="share-single">
  <button id="shareMain" class="share-main-btn">
    ğŸ“¤ <span class="label"></span>
  </button>
</div>
    </div>

    <div class="mapWrap" id="mapWrap">
      <div class="hud">
        <button id="btnWorld" title="Ein Erdball (ohne Wrap / ohne doppelte Kontinente)">Weltansicht</button>
        <button id="btnCard" title="Screenshot vom Erdball (Graustufe, dunkel, mit Lichtern)">Karte generieren</button>
      </div>

      <div id="map"></div>
      <div class="mapTint"></div>
      <div class="mapShade"></div>
    </div>

    <p class="hint" id="hint"></p>
    <p class="status" id="status"></p>
  </div>

<script>
/* -------------------------
   1) PROMPTER (unverÃ¤ndert, mit Zeilenumbruch)
-------------------------- */
// --- Language selection (URL override ?lang=xx, otherwise browser) ---
function getLangFromUrl() {
  const p = new URLSearchParams(location.search);
  const v = (p.get("lang") || "").trim();
  return v ? v.toLowerCase() : null;
}

function normalizeLang(tag) {
  if (!tag) return "en";
  const t = tag.toLowerCase();

  // Chinese script handling
  if (t.startsWith("zh")) return "zh";

  // Map "in" to "id" (old code), "iw" to "he" etc.
  if (t.startsWith("in")) return "id";
  if (t.startsWith("iw")) return "he";

  // Use primary subtag: "de-de" -> "de"
  return t.split("-")[0];
}

/*const SUPPORTED = ["en","es","hi","zh","ar","ru","de"]; // de optional for you*/
  // Alle unterstÃ¼tzten Sprachen (Basis + ErgÃ¤nzungen 1â€“9)
const SUPPORTED = [
  "en", // English
  "de", // Deutsch
  "es", // EspaÃ±ol
  "fr", // FranÃ§ais
  "pt", // PortuguÃªs (pt-BR wird auf pt normalisiert)
  "ru", // Ğ ÑƒÑÑĞºĞ¸Ğ¹
  "ar", // Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
  "hi", // à¤¹à¤¿à¤¨à¥à¤¦à¥€
  "bn", // à¦¬à¦¾à¦‚à¦²à¦¾
  "ur", // Ø§Ø±Ø¯Ùˆ
  "zh", // ä¸­æ–‡ (zh-*, zh-Hans, zh-Hant -> zh)
  "ja", // æ—¥æœ¬èª
  "ko", // í•œêµ­ì–´
  "vi", // Tiáº¿ng Viá»‡t
  "tr", // TÃ¼rkÃ§e
  "sw", // Kiswahili
  "id"  // Bahasa Indonesia
];

function pickLanguage() {
  // 1) URL override â€“ absoluter Vorrang
  const urlLang = normalizeLang(getLangFromUrl());
  if (urlLang && SUPPORTED.includes(urlLang)) {
    return urlLang;
  }

  const prefs = (navigator.languages && navigator.languages.length)
    ? navigator.languages.map(normalizeLang)
    : [normalizeLang(navigator.language || "en")];

  // 3) Erste unterstÃ¼tzte Sprache aus den Preferences
  for (const lang of prefs) {
    if (SUPPORTED.includes(lang)) return lang;
  }

  // 4) Fallback
  return "en";
}

const LANG = pickLanguage();
const badge = document.getElementById("langBadge");
if (badge) badge.textContent = LANG.toUpperCase();

const CHAR_BASED_LANGS = ["zh", "ja", "ko"];

// --- Teleprompter texts per language ---
const TP = {
  de: [
    "Wir denken fast nie daran.",
    "Unser Leben\nauf dieser kleinen blauen Kugel im Weltall.",
    "In diesem Augenzwinkern\nlange nach dem Urknall.",
    "Es ist â€“\nnach all unserem Wissen â€“\neinzigartig.",
    "Das macht uns alle besonders.\nUnd es verbindet uns.",
    "Hier kannst du ein Licht setzen.\nUnd sehen,\ndass viele dasselbe fÃ¼hlen."
  ],

  en: [
    "We almost never think about it.",
    "Our lives\non this small blue planet in space.",
    "In this brief blink\nlong after the Big Bang.",
    "That it exists at all â€“\nas far as we know â€“\nis unique.",
    "That makes us all special.\nAnd it connects us.",
    "Here you can place a light.\nAnd see\nthat many feel the same."
  ],

  es: [
    "Casi nunca pensamos en ello.",
    "Nuestra vida\nen esta pequeÃ±a esfera azul en el espacio.",
    "En este parpadeo fugaz\nmucho despuÃ©s del Big Bang.",
    "Que exista â€“\nsegÃºn todo lo que sabemos â€“\nes Ãºnico.",
    "Eso nos hace especiales a todos.\nY nos conecta.",
    "AquÃ­ puedes colocar una luz.\nY ver\nque muchos sienten lo mismo."
  ],

  fr: [
    "Nous nâ€™y pensons presque jamais.",
    "Ã€ notre vie\nsur cette petite planÃ¨te bleue dans lâ€™espace.",
    "Dans ce clin dâ€™Å“il fugace\nlongtemps aprÃ¨s le Big Bang.",
    "Le fait que cela existe â€“\nselon ce que nous savons â€“\nest unique.",
    "Cela nous rend tous particuliers.\nEt nous relie.",
    "Ici, tu peux placer une lumiÃ¨re.\nEt voir\nque beaucoup ressentent la mÃªme chose."
  ],

  pt: [
    "Quase nunca pensamos nisso.",
    "Na nossa vida\nneste pequeno planeta azul no espaÃ§o.",
    "Neste breve piscar de olhos\nmuito depois do Big Bang.",
    "Que isso exista â€“\npelo que sabemos â€“\nÃ© Ãºnico.",
    "Isso nos torna especiais.\nE nos conecta.",
    "Aqui vocÃª pode colocar uma luz.\nE ver\nque muitos sentem o mesmo."
  ],

  ru: [
    "ĞœÑ‹ Ğ¿Ğ¾Ñ‡Ñ‚Ğ¸ Ğ½Ğ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ¾Ğ± ÑÑ‚Ğ¾Ğ¼ Ğ½Ğµ Ğ´ÑƒĞ¼Ğ°ĞµĞ¼.",
    "Ğ Ğ½Ğ°ÑˆĞµĞ¹ Ğ¶Ğ¸Ğ·Ğ½Ğ¸\nĞ½Ğ° ÑÑ‚Ğ¾Ğ¹ Ğ¼Ğ°Ğ»ĞµĞ½ÑŒĞºĞ¾Ğ¹ Ğ³Ğ¾Ğ»ÑƒĞ±Ğ¾Ğ¹ Ğ¿Ğ»Ğ°Ğ½ĞµÑ‚Ğµ Ğ² ĞºĞ¾ÑĞ¼Ğ¾ÑĞµ.",
    "Ğ’ ÑÑ‚Ğ¾Ğ¼ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¾Ğ¼ Ğ¼Ğ³Ğ½Ğ¾Ğ²ĞµĞ½Ğ¸Ğ¸\nÑĞ¿ÑƒÑÑ‚Ñ Ğ´Ğ¾Ğ»Ğ³Ğ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ğ¿Ğ¾ÑĞ»Ğµ Ğ‘Ğ¾Ğ»ÑŒÑˆĞ¾Ğ³Ğ¾ Ğ²Ğ·Ñ€Ñ‹Ğ²Ğ°.",
    "Ğ¢Ğ¾, Ñ‡Ñ‚Ğ¾ Ğ¾Ğ½Ğ° ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚ â€“\nĞ½Ğ°ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ Ğ¼Ñ‹ Ğ·Ğ½Ğ°ĞµĞ¼ â€“\nÑƒĞ½Ğ¸ĞºĞ°Ğ»ÑŒĞ½Ğ¾.",
    "Ğ­Ñ‚Ğ¾ Ğ´ĞµĞ»Ğ°ĞµÑ‚ Ğ½Ğ°Ñ Ğ²ÑĞµÑ… Ğ¾ÑĞ¾Ğ±ĞµĞ½Ğ½Ñ‹Ğ¼Ğ¸.\nĞ˜ ÑĞ¾ĞµĞ´Ğ¸Ğ½ÑĞµÑ‚ Ğ½Ğ°Ñ.",
    "Ğ—Ğ´ĞµÑÑŒ Ñ‚Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑˆÑŒ Ğ·Ğ°Ğ¶ĞµÑ‡ÑŒ ÑĞ²ĞµÑ‚.\nĞ˜ ÑƒĞ²Ğ¸Ğ´ĞµÑ‚ÑŒ,\nÑ‡Ñ‚Ğ¾ Ğ¼Ğ½Ğ¾Ğ³Ğ¸Ğµ Ñ‡ÑƒĞ²ÑÑ‚Ğ²ÑƒÑÑ‚ Ñ‚Ğ¾ Ğ¶Ğµ ÑĞ°Ğ¼Ğ¾Ğµ."
  ],

  ar: [
    "Ù†Ø§Ø¯Ø±Ù‹Ø§ Ù…Ø§ Ù†ÙÙƒØ± ÙÙŠ Ø°Ù„Ùƒ.",
    "ÙÙŠ Ø­ÙŠØ§ØªÙ†Ø§\nØ¹Ù„Ù‰ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆÙƒØ¨ Ø§Ù„Ø£Ø²Ø±Ù‚ Ø§Ù„ØµØºÙŠØ± ÙÙŠ Ø§Ù„ÙØ¶Ø§Ø¡.",
    "ÙÙŠ Ù‡Ø°Ù‡ Ø§Ù„Ù„Ù…Ø­Ø© Ø§Ù„Ø®Ø§Ø·ÙØ©\nØ¨Ø¹Ø¯ Ø²Ù…Ù† Ø·ÙˆÙŠÙ„ Ù…Ù† Ø§Ù„Ø§Ù†ÙØ¬Ø§Ø± Ø§Ù„Ø¹Ø¸ÙŠÙ….",
    "Ø£Ù† Ù‡Ø°Ø§ Ø§Ù„ÙˆØ¬ÙˆØ¯ Ù‚Ø§Ø¦Ù… â€“\nØ­Ø³Ø¨ Ù…Ø§ Ù†Ø¹Ø±Ù â€“\nÙ‡Ùˆ Ø£Ù…Ø± ÙØ±ÙŠØ¯.",
    "Ù‡Ø°Ø§ ÙŠØ¬Ø¹Ù„Ù†Ø§ Ø¬Ù…ÙŠØ¹Ù‹Ø§ Ù…Ù…ÙŠØ²ÙŠÙ†.\nÙˆÙŠØ±Ø¨Ø·Ù†Ø§.",
    "Ù‡Ù†Ø§ ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªØ¶Ø¹ Ù†ÙˆØ±Ù‹Ø§.\nÙˆØªØ±Ù‰\nØ£Ù† ÙƒØ«ÙŠØ±ÙŠÙ† ÙŠØ´Ø¹Ø±ÙˆÙ† Ø¨Ø§Ù„Ø´ÙŠØ¡ Ù†ÙØ³Ù‡."
  ],

  hi: [
    "à¤¹à¤® à¤²à¤—à¤­à¤— à¤•à¤­à¥€ à¤‡à¤¸à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚ à¤¨à¤¹à¥€à¤‚ à¤¸à¥‹à¤šà¤¤à¥‡à¥¤",
    "à¤…à¤ªà¤¨à¥‡ à¤œà¥€à¤µà¤¨ à¤•à¥‡ à¤¬à¤¾à¤°à¥‡ à¤®à¥‡à¤‚\nà¤‡à¤¸ à¤›à¥‹à¤Ÿà¥‡ à¤¸à¥‡ à¤¨à¥€à¤²à¥‡ à¤—à¥à¤°à¤¹ à¤ªà¤°à¥¤",
    "à¤‡à¤¸ à¤ªà¤² à¤­à¤° à¤®à¥‡à¤‚\nà¤®à¤¹à¤¾à¤µà¤¿à¤¸à¥à¤«à¥‹à¤Ÿ à¤•à¥‡ à¤¬à¤¹à¥à¤¤ à¤¬à¤¾à¤¦à¥¤",
    "à¤•à¤¿ à¤‡à¤¸à¤•à¤¾ à¤…à¤¸à¥à¤¤à¤¿à¤¤à¥à¤µ à¤¹à¥ˆ â€“\nà¤œà¤¿à¤¤à¤¨à¤¾ à¤¹à¤® à¤œà¤¾à¤¨à¤¤à¥‡ à¤¹à¥ˆà¤‚ â€“\nà¤µà¤¹ à¤…à¤¦à¥à¤µà¤¿à¤¤à¥€à¤¯ à¤¹à¥ˆà¥¤",
    "à¤¯à¤¹ à¤¹à¤® à¤¸à¤­à¥€ à¤•à¥‹ à¤–à¤¾à¤¸ à¤¬à¤¨à¤¾à¤¤à¤¾ à¤¹à¥ˆà¥¤\nà¤”à¤° à¤¹à¤®à¥‡à¤‚ à¤œà¥‹à¤¡à¤¼à¤¤à¤¾ à¤¹à¥ˆà¥¤",
    "à¤¯à¤¹à¤¾à¤ à¤†à¤ª à¤à¤• à¤°à¥‹à¤¶à¤¨à¥€ à¤°à¤– à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤\nà¤”à¤° à¤¦à¥‡à¤– à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚\nà¤•à¤¿ à¤¬à¤¹à¥à¤¤ à¤¸à¥‡ à¤²à¥‹à¤— à¤µà¤¹à¥€ à¤®à¤¹à¤¸à¥‚à¤¸ à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤"
  ],

  bn: [
    "à¦†à¦®à¦°à¦¾ à¦ªà§à¦°à¦¾à¦¯à¦¼ à¦•à¦–à¦¨à§‹à¦‡ à¦à¦Ÿà¦¾ à¦¨à¦¿à¦¯à¦¼à§‡ à¦­à¦¾à¦¬à¦¿ à¦¨à¦¾à¥¤",
    "à¦†à¦®à¦¾à¦¦à§‡à¦° à¦œà§€à¦¬à¦¨\nà¦à¦‡ à¦›à§‹à¦Ÿ à¦¨à§€à¦² à¦—à§à¦°à¦¹à§‡à¥¤",
    "à¦à¦‡ à¦•à§à¦·à¦£à¦¿à¦• à¦šà§‹à¦–à§‡à¦° à¦ªà¦²à¦•à§‡\nà¦¬à¦¿à¦— à¦¬à§à¦¯à¦¾à¦‚à¦¯à¦¼à§‡à¦° à¦¬à¦¹à§ à¦ªà¦°à§‡à¥¤",
    "à¦à¦° à¦…à¦¸à§à¦¤à¦¿à¦¤à§à¦¬ â€“\nà¦¯à¦¤à¦Ÿà§à¦•à§ à¦†à¦®à¦°à¦¾ à¦œà¦¾à¦¨à¦¿ â€“\nà¦…à¦¨à¦¨à§à¦¯à¥¤",
    "à¦à¦Ÿà¦¿ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¸à¦¬à¦¾à¦‡à¦•à§‡ à¦¬à¦¿à¦¶à§‡à¦· à¦•à¦°à§‡ à¦¤à§‹à¦²à§‡à¥¤\nà¦à¦¬à¦‚ à¦†à¦®à¦¾à¦¦à§‡à¦° à¦¯à§à¦•à§à¦¤ à¦•à¦°à§‡à¥¤",
    "à¦à¦–à¦¾à¦¨à§‡ à¦¤à§à¦®à¦¿ à¦à¦•à¦Ÿà¦¿ à¦†à¦²à§‹ à¦¬à¦¸à¦¾à¦¤à§‡ à¦ªà¦¾à¦°à§‹à¥¤\nà¦à¦¬à¦‚ à¦¦à§‡à¦–à¦¤à§‡ à¦ªà¦¾à¦°à§‹\nà¦¯à§‡ à¦…à¦¨à§‡à¦•à§‡à¦‡ à¦à¦•à¦‡ à¦…à¦¨à§à¦­à¦¬ à¦•à¦°à§‡à¥¤"
  ],

  ur: [
    "ÛÙ… ØªÙ‚Ø±ÛŒØ¨Ø§Ù‹ Ú©Ø¨Ú¾ÛŒ Ø§Ø³ Ú©Û’ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº Ù†ÛÛŒÚº Ø³ÙˆÚ†ØªÛ’Û”",
    "Ø§Ù¾Ù†ÛŒ Ø²Ù†Ø¯Ú¯ÛŒ Ú©Û’ Ø¨Ø§Ø±Û’ Ù…ÛŒÚº\nØ§Ø³ Ú†Ú¾ÙˆÙ¹Û’ Ø³Û’ Ù†ÛŒÙ„Û’ Ø³ÛŒØ§Ø±Û’ Ù¾Ø±Û”",
    "Ø§Ø³ Ù¾Ù„ Ø¨Ú¾Ø± Ù…ÛŒÚº\nØ¨Ú¯ Ø¨ÛŒÙ†Ú¯ Ú©Û’ Ø¨ÛØª Ø¨Ø¹Ø¯Û”",
    "Ú©Û Ø§Ø³ Ú©Ø§ ÙˆØ¬ÙˆØ¯ ÛÛ’ â€“\nØ¬ØªÙ†Ø§ ÛÙ… Ø¬Ø§Ù†ØªÛ’ ÛÛŒÚº â€“\nÙ…Ù†ÙØ±Ø¯ ÛÛ’Û”",
    "ÛŒÛ ÛÙ… Ø³Ø¨ Ú©Ùˆ Ø®Ø§Øµ Ø¨Ù†Ø§ØªØ§ ÛÛ’Û”\nØ§ÙˆØ± ÛÙ…ÛŒÚº Ø¬ÙˆÚ‘ØªØ§ ÛÛ’Û”",
    "ÛŒÛØ§Úº Ø¢Ù¾ Ø§ÛŒÚ© Ø±ÙˆØ´Ù†ÛŒ Ø±Ú©Ú¾ Ø³Ú©ØªÛ’ ÛÛŒÚºÛ”\nØ§ÙˆØ± Ø¯ÛŒÚ©Ú¾ Ø³Ú©ØªÛ’ ÛÛŒÚº\nÚ©Û Ø¨ÛØª Ø³Û’ Ù„ÙˆÚ¯ ÛŒÛÛŒ Ù…Ø­Ø³ÙˆØ³ Ú©Ø±ØªÛ’ ÛÛŒÚºÛ”"
  ],

  zh: [
    "æˆ‘ä»¬å‡ ä¹ä»ä¸å»æƒ³è¿™äº›ã€‚",
    "å…³äºæˆ‘ä»¬çš„ç”Ÿæ´»\nåœ¨è¿™é¢—å°å°çš„è“è‰²æ˜Ÿçƒä¸Šã€‚",
    "åœ¨è¿™çŸ­æš‚çš„ä¸€ç¬é—´ï¼Œ\nåœ¨å®‡å®™å¤§çˆ†ç‚¸ä¹‹åå¾ˆä¹…ã€‚",
    "å®ƒçš„å­˜åœ¨æœ¬èº« â€“\nå°±æˆ‘ä»¬æ‰€çŸ¥ â€“\næ˜¯ç‹¬ä¸€æ— äºŒçš„ã€‚",
    "è¿™è®©æˆ‘ä»¬æ¯ä¸ªäººéƒ½å¾ˆç‰¹åˆ«ã€‚\nä¹Ÿå°†æˆ‘ä»¬è¿æ¥åœ¨ä¸€èµ·ã€‚",
    "åœ¨è¿™é‡Œï¼Œä½ å¯ä»¥ç‚¹äº®ä¸€ç›ç¯ã€‚\nå¹¶çœ‹åˆ°\næœ‰è®¸å¤šäººæœ‰ç€åŒæ ·çš„æ„Ÿå—ã€‚"
  ],

  ja: [
    "ç§ãŸã¡ã¯ã»ã¨ã‚“ã©è€ƒãˆã¾ã›ã‚“ã€‚",
    "ã“ã®å°ã•ãªé’ã„æƒ‘æ˜Ÿã§ã®\nç§ãŸã¡ã®æš®ã‚‰ã—ã«ã¤ã„ã¦ã€‚",
    "ãƒ“ãƒƒã‚°ãƒãƒ³ã‹ã‚‰ãšã£ã¨å¾Œã®\nã“ã®ä¸€ç¬ã«ã¤ã„ã¦ã€‚",
    "ãã‚ŒãŒå­˜åœ¨ã—ã¦ã„ã‚‹ã“ã¨è‡ªä½“ãŒ â€“\nç§ãŸã¡ã®çŸ¥ã‚‹é™ã‚Š â€“\nç‰¹åˆ¥ã§ã™ã€‚",
    "ãã‚Œã¯ç§ãŸã¡çš†ã‚’ç‰¹åˆ¥ã«ã—ã€\nç§ãŸã¡ã‚’ã¤ãªãã¾ã™ã€‚",
    "ã“ã“ã§å…‰ã‚’ç½®ãã“ã¨ãŒã§ãã¾ã™ã€‚\nãã—ã¦\nå¤šãã®äººãŒåŒã˜ã‚ˆã†ã«\næ„Ÿã˜ã¦ã„ã‚‹ã“ã¨ãŒè¦‹ãˆã¾ã™ã€‚"
  ],

  ko: [
    "ìš°ë¦¬ëŠ” ê±°ì˜ ìƒê°í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
    "ì´ ì‘ì€ í‘¸ë¥¸ í–‰ì„±ì—ì„œì˜\nìš°ë¦¬ì˜ ì‚¶ì— ëŒ€í•´.",
    "ë¹…ë±… ì´í›„ í•œì°¸ì´ ì§€ë‚œ\nì´ ì§§ì€ ìˆœê°„ì— ëŒ€í•´.",
    "ê·¸ ì¡´ì¬ ìì²´ê°€ â€“\nìš°ë¦¬ê°€ ì•„ëŠ” í•œ â€“\níŠ¹ë³„í•©ë‹ˆë‹¤.",
    "ê·¸ê²ƒì€ ìš°ë¦¬ ëª¨ë‘ë¥¼ íŠ¹ë³„í•˜ê²Œ ë§Œë“¤ê³ ,\nìš°ë¦¬ë¥¼ ì—°ê²°í•©ë‹ˆë‹¤.",
    "ì—¬ê¸°ì—ì„œ ë¹›ì„ ë†“ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.\nê·¸ë¦¬ê³ \në§ì€ ì´ë“¤ì´ ê°™ì€ ê°ì •ì„\nëŠë¼ê³  ìˆìŒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
  ],

  vi: [
    "ChÃºng ta háº§u nhÆ° khÃ´ng bao giá» nghÄ© Ä‘áº¿n Ä‘iá»u Ä‘Ã³.",
    "Vá» cuá»™c sá»‘ng cá»§a mÃ¬nh\ntrÃªn hÃ nh tinh xanh nhá» bÃ© nÃ y.",
    "Trong khoáº£nh kháº¯c chá»›p máº¯t nÃ y\nráº¥t lÃ¢u sau Vá»¥ Ná»• Lá»›n.",
    "Viá»‡c nÃ³ tá»“n táº¡i â€“\nnhÆ° nhá»¯ng gÃ¬ chÃºng ta biáº¿t â€“\nlÃ  Ä‘iá»u Ä‘á»™c nháº¥t.",
    "Äiá»u Ä‘Ã³ khiáº¿n táº¥t cáº£ chÃºng ta trá»Ÿ nÃªn Ä‘áº·c biá»‡t.\nVÃ  káº¿t ná»‘i chÃºng ta.",
    "Táº¡i Ä‘Ã¢y, báº¡n cÃ³ thá»ƒ Ä‘áº·t má»™t Ã¡nh sÃ¡ng.\nVÃ  tháº¥y\nráº±ng nhiá»u ngÆ°á»i cáº£m nháº­n Ä‘iá»u tÆ°Æ¡ng tá»±."
  ],

  tr: [
    "Bunu neredeyse hiÃ§ dÃ¼ÅŸÃ¼nmeyiz.",
    "Bu kÃ¼Ã§Ã¼k mavi gezegendeki\nhayatÄ±mÄ±zÄ±.",
    "BÃ¼yÃ¼k Patlamaâ€™dan Ã§ok sonra\nbu gÃ¶z aÃ§Ä±p kapama anÄ±nda.",
    "Onun var olmasÄ± â€“\nbildiÄŸimiz kadarÄ±yla â€“\ntekdir.",
    "Bu hepimizi Ã¶zel kÄ±lar.\nVe birbirimize baÄŸlar.",
    "Burada bir Ä±ÅŸÄ±k bÄ±rakabilirsin.\nVe gÃ¶rebilirsin\nki birÃ§ok kiÅŸi aynÄ± ÅŸeyi hissediyor."
  ],

  sw: [
    "Karibu hatufikirii kuhusu hilo.",
    "Kuhusu maisha yetu\nkwenye sayari hii ndogo ya buluu.",
    "Katika mngâ€™ao huu mfupi\nmuda mrefu baada ya Mlipo Mkuu.",
    "Kwamba yapo â€“\nkadiri tunavyojua â€“\nni ya kipekee.",
    "Hilo hutufanya sote tuwe wa pekee.\nNa hutunganisha.",
    "Hapa unaweza kuweka mwanga.\nNa kuona\nkwamba wengi wanahisi vivyo hivyo."
  ],

  id: [
    "Kita hampir tidak pernah memikirkannya.",
    "Tentang kehidupan kita\ndi planet biru kecil ini.",
    "Dalam kedipan singkat ini\nlama setelah Dentuman Besar.",
    "Bahwa itu ada â€“\nsejauh yang kita ketahui â€“\nadalah sesuatu yang unik.",
    "Hal itu membuat kita semua istimewa.\nDan menghubungkan kita.",
    "Di sini kamu bisa menempatkan sebuah cahaya.\nDan melihat\nbahwa banyak yang merasakan hal yang sama."
  ]
};

  const UI = {
  en: {
    world: "World view",
    card: "Generate map",
    hint: "Click on the map to place or move your light. (One light per browser.)",
    status_set: "Your light is set. You can move it by clicking on the map.",
    status_empty: "Place your light by clicking on the map.",
    status_error_load: "Could not load lights.",
    status_error_save: "Saving failed.",
    status_export: "Creating imageâ€¦",
    status_done: "Done."
  },

  de: {
    world: "Weltansicht",
    card: "Karte generieren",
    hint: "Klicke auf die Karte, um dein Licht zu setzen oder zu verschieben. (Nur ein Licht pro Browser.)",
    status_set: "Dein Licht ist gesetzt. Du kannst es durch Klicken verschieben.",
    status_empty: "Setze dein Licht mit einem Klick auf die Karte.",
    status_error_load: "Konnte Lichter nicht laden.",
    status_error_save: "Speichern fehlgeschlagen.",
    status_export: "Erzeuge Bildâ€¦",
    status_done: "Fertig."
  },

  es: {
    world: "Vista mundial",
    card: "Generar mapa",
    hint: "Haz clic en el mapa para colocar o mover tu luz. (Una luz por navegador.)",
    status_set: "Tu luz estÃ¡ colocada. Puedes moverla haciendo clic.",
    status_empty: "Coloca tu luz haciendo clic en el mapa.",
    status_error_load: "No se pudieron cargar las luces.",
    status_error_save: "Error al guardar.",
    status_export: "Creando imagenâ€¦",
    status_done: "Listo."
  },

  fr: {
    world: "Vue du monde",
    card: "GÃ©nÃ©rer la carte",
    hint: "Cliquez sur la carte pour placer ou dÃ©placer votre lumiÃ¨re.",
    status_set: "Votre lumiÃ¨re est placÃ©e. Vous pouvez la dÃ©placer.",
    status_empty: "Placez votre lumiÃ¨re en cliquant sur la carte.",
    status_error_load: "Impossible de charger les lumiÃ¨res.",
    status_error_save: "Ã‰chec de lâ€™enregistrement.",
    status_export: "CrÃ©ation de lâ€™imageâ€¦",
    status_done: "TerminÃ©."
  },

  pt: {
    world: "VisÃ£o mundial",
    card: "Gerar mapa",
    hint: "Clique no mapa para colocar ou mover sua luz.",
    status_set: "Sua luz foi colocada. VocÃª pode movÃª-la.",
    status_empty: "Coloque sua luz clicando no mapa.",
    status_error_load: "NÃ£o foi possÃ­vel carregar as luzes.",
    status_error_save: "Falha ao salvar.",
    status_export: "Gerando imagemâ€¦",
    status_done: "ConcluÃ­do."
  },

  ru: {
    world: "Ğ’Ğ¸Ğ´ Ğ¼Ğ¸Ñ€Ğ°",
    card: "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞºĞ°Ñ€Ñ‚Ñƒ",
    hint: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ñƒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ñ€Ğ°Ğ·Ğ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ Ğ¸Ğ»Ğ¸ Ğ¿ĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ ÑĞ²ĞµÑ‚.",
    status_set: "Ğ’Ğ°Ñˆ ÑĞ²ĞµÑ‚ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½. Ğ’Ñ‹ Ğ¼Ğ¾Ğ¶ĞµÑ‚Ğµ ĞµĞ³Ğ¾ Ğ¿ĞµÑ€ĞµĞ¼ĞµÑÑ‚Ğ¸Ñ‚ÑŒ.",
    status_empty: "ĞĞ°Ğ¶Ğ¼Ğ¸Ñ‚Ğµ Ğ½Ğ° ĞºĞ°Ñ€Ñ‚Ñƒ, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ ÑĞ²ĞµÑ‚.",
    status_error_load: "ĞĞµ ÑƒĞ´Ğ°Ğ»Ğ¾ÑÑŒ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ñ‚ÑŒ Ğ¾Ğ³Ğ½Ğ¸.",
    status_error_save: "ĞÑˆĞ¸Ğ±ĞºĞ° ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ¸Ñ.",
    status_export: "Ğ¡Ğ¾Ğ·Ğ´Ğ°Ğ½Ğ¸Ğµ Ğ¸Ğ·Ğ¾Ğ±Ñ€Ğ°Ğ¶ĞµĞ½Ğ¸Ñâ€¦",
    status_done: "Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ğ¾."
  },

  ar: {
    world: "Ø¹Ø±Ø¶ Ø§Ù„Ø¹Ø§Ù„Ù…",
    card: "Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø®Ø±ÙŠØ·Ø©",
    hint: "Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø© Ù„ÙˆØ¶Ø¹ Ø§Ù„Ø¶ÙˆØ¡ Ø£Ùˆ ØªØ­Ø±ÙŠÙƒÙ‡.",
    status_set: "ØªÙ… ÙˆØ¶Ø¹ Ø¶ÙˆØ¦Ùƒ. ÙŠÙ…ÙƒÙ†Ùƒ ØªØ­Ø±ÙŠÙƒÙ‡.",
    status_empty: "Ø¶Ø¹ Ø¶ÙˆØ¡Ùƒ Ø¨Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©.",
    status_error_load: "ØªØ¹Ø°Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø¶ÙˆØ§Ø¡.",
    status_error_save: "ÙØ´Ù„ Ø§Ù„Ø­ÙØ¸.",
    status_export: "Ø¬Ø§Ø±Ù Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„ØµÙˆØ±Ø©â€¦",
    status_done: "ØªÙ…."
  },

  hi: {
    world: "à¤µà¤¿à¤¶à¥à¤µ à¤¦à¥ƒà¤¶à¥à¤¯",
    card: "à¤®à¤¾à¤¨à¤šà¤¿à¤¤à¥à¤° à¤¬à¤¨à¤¾à¤à¤",
    hint: "à¤…à¤ªà¤¨à¥€ à¤°à¥‹à¤¶à¤¨à¥€ à¤²à¤—à¤¾à¤¨à¥‡ à¤¯à¤¾ à¤¸à¥à¤¥à¤¾à¤¨ à¤¬à¤¦à¤²à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤®à¤¾à¤¨à¤šà¤¿à¤¤à¥à¤° à¤ªà¤° à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚à¥¤",
    status_set: "à¤†à¤ªà¤•à¥€ à¤°à¥‹à¤¶à¤¨à¥€ à¤¸à¥‡à¤Ÿ à¤¹à¥ˆà¥¤ à¤†à¤ª à¤‡à¤¸à¥‡ à¤¬à¤¦à¤² à¤¸à¤•à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤",
    status_empty: "à¤®à¤¾à¤¨à¤šà¤¿à¤¤à¥à¤° à¤ªà¤° à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¤•à¥‡ à¤…à¤ªà¤¨à¥€ à¤°à¥‹à¤¶à¤¨à¥€ à¤²à¤—à¤¾à¤à¤à¥¤",
    status_error_load: "à¤°à¥‹à¤¶à¤¨à¤¿à¤¯à¤¾à¤ à¤²à¥‹à¤¡ à¤¨à¤¹à¥€à¤‚ à¤¹à¥‹ à¤¸à¤•à¥€à¤‚à¥¤",
    status_error_save: "à¤¸à¤¹à¥‡à¤œà¤¨à¤¾ à¤µà¤¿à¤«à¤² à¤°à¤¹à¤¾à¥¤",
    status_export: "à¤šà¤¿à¤¤à¥à¤° à¤¬à¤¨à¤¾à¤¯à¤¾ à¤œà¤¾ à¤°à¤¹à¤¾ à¤¹à¥ˆâ€¦",
    status_done: "à¤ªà¥‚à¤°à¥à¤£à¥¤"
  },

  bn: {
    world: "à¦¬à¦¿à¦¶à§à¦¬ à¦¦à§ƒà¦¶à§à¦¯",
    card: "à¦®à¦¾à¦¨à¦šà¦¿à¦¤à§à¦° à¦¤à§ˆà¦°à¦¿ à¦•à¦°à§à¦¨",
    hint: "à¦†à¦ªà¦¨à¦¾à¦° à¦†à¦²à§‹ à¦¬à¦¸à¦¾à¦¤à§‡ à¦¬à¦¾ à¦¸à¦°à¦¾à¦¤à§‡ à¦®à¦¾à¦¨à¦šà¦¿à¦¤à§à¦°à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§à¦¨à¥¤",
    status_set: "à¦†à¦ªà¦¨à¦¾à¦° à¦†à¦²à§‹ à¦¬à¦¸à¦¾à¦¨à§‹ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤ à¦†à¦ªà¦¨à¦¿ à¦à¦Ÿà¦¿ à¦¸à¦°à¦¾à¦¤à§‡ à¦ªà¦¾à¦°à§‡à¦¨à¥¤",
    status_empty: "à¦®à¦¾à¦¨à¦šà¦¿à¦¤à§à¦°à§‡ à¦•à§à¦²à¦¿à¦• à¦•à¦°à§‡ à¦†à¦ªà¦¨à¦¾à¦° à¦†à¦²à§‹ à¦¬à¦¸à¦¾à¦¨à¥¤",
    status_error_load: "à¦†à¦²à§‹ à¦²à§‹à¦¡ à¦•à¦°à¦¾ à¦¯à¦¾à¦¯à¦¼à¦¨à¦¿à¥¤",
    status_error_save: "à¦¸à¦‚à¦°à¦•à§à¦·à¦£ à¦¬à§à¦¯à¦°à§à¦¥ à¦¹à¦¯à¦¼à§‡à¦›à§‡à¥¤",
    status_export: "à¦›à¦¬à¦¿ à¦¤à§ˆà¦°à¦¿ à¦•à¦°à¦¾ à¦¹à¦šà§à¦›à§‡â€¦",
    status_done: "à¦¸à¦®à§à¦ªà¦¨à§à¦¨à¥¤"
  },

  ur: {
    world: "Ø¹Ø§Ù„Ù…ÛŒ Ù…Ù†Ø¸Ø±",
    card: "Ù†Ù‚Ø´Û Ø¨Ù†Ø§Ø¦ÛŒÚº",
    hint: "Ø§Ù¾Ù†ÛŒ Ø±ÙˆØ´Ù†ÛŒ Ø±Ú©Ú¾Ù†Û’ ÛŒØ§ Ù…Ù†ØªÙ‚Ù„ Ú©Ø±Ù†Û’ Ú©Û’ Ù„ÛŒÛ’ Ù†Ù‚Ø´Û’ Ù¾Ø± Ú©Ù„Ú© Ú©Ø±ÛŒÚºÛ”",
    status_set: "Ø¢Ù¾ Ú©ÛŒ Ø±ÙˆØ´Ù†ÛŒ Ø³ÛŒÙ¹ ÛÙˆ Ú¯Ø¦ÛŒ ÛÛ’Û”",
    status_empty: "Ù†Ù‚Ø´Û’ Ù¾Ø± Ú©Ù„Ú© Ú©Ø± Ú©Û’ Ø§Ù¾Ù†ÛŒ Ø±ÙˆØ´Ù†ÛŒ Ø±Ú©Ú¾ÛŒÚºÛ”",
    status_error_load: "Ø±ÙˆØ´Ù†ÛŒ Ù„ÙˆÚˆ Ù†ÛÛŒÚº ÛÙˆ Ø³Ú©ÛŒÛ”",
    status_error_save: "Ù…Ø­ÙÙˆØ¸ Ú©Ø±Ù†Ø§ Ù†Ø§Ú©Ø§Ù… Ø±ÛØ§Û”",
    status_export: "ØªØµÙˆÛŒØ± Ø¨Ù†Ø§Ø¦ÛŒ Ø¬Ø§ Ø±ÛÛŒ ÛÛ’â€¦",
    status_done: "Ù…Ú©Ù…Ù„Û”"
  },

  zh: {
    world: "ä¸–ç•Œè§†å›¾",
    card: "ç”Ÿæˆåœ°å›¾",
    hint: "ç‚¹å‡»åœ°å›¾ä»¥æ”¾ç½®æˆ–ç§»åŠ¨ä½ çš„å…‰ç‚¹ã€‚",
    status_set: "ä½ çš„å…‰ç‚¹å·²è®¾ç½®ï¼Œå¯ä»¥ç§»åŠ¨ã€‚",
    status_empty: "ç‚¹å‡»åœ°å›¾æ”¾ç½®ä½ çš„å…‰ç‚¹ã€‚",
    status_error_load: "æ— æ³•åŠ è½½å…‰ç‚¹ã€‚",
    status_error_save: "ä¿å­˜å¤±è´¥ã€‚",
    status_export: "æ­£åœ¨ç”Ÿæˆå›¾ç‰‡â€¦",
    status_done: "å®Œæˆã€‚"
  },

  ja: {
    world: "ä¸–ç•Œè¡¨ç¤º",
    card: "åœ°å›³ã‚’ç”Ÿæˆ",
    hint: "åœ°å›³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å…‰ã‚’ç½®ã„ãŸã‚Šå‹•ã‹ã—ãŸã‚Šã—ã¦ãã ã•ã„ã€‚",
    status_set: "å…‰ãŒè¨­å®šã•ã‚Œã¾ã—ãŸã€‚ç§»å‹•ã§ãã¾ã™ã€‚",
    status_empty: "åœ°å›³ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦å…‰ã‚’ç½®ã„ã¦ãã ã•ã„ã€‚",
    status_error_load: "å…‰ã‚’èª­ã¿è¾¼ã‚ã¾ã›ã‚“ã§ã—ãŸã€‚",
    status_error_save: "ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸã€‚",
    status_export: "ç”»åƒã‚’ä½œæˆä¸­â€¦",
    status_done: "å®Œäº†ã€‚"
  },

  ko: {
    world: "ì„¸ê³„ ë³´ê¸°",
    card: "ì§€ë„ ìƒì„±",
    hint: "ì§€ë„ë¥¼ í´ë¦­í•˜ì—¬ ë¹›ì„ ë†“ê±°ë‚˜ ì´ë™í•˜ì„¸ìš”.",
    status_set: "ë¹›ì´ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë™í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
    status_empty: "ì§€ë„ë¥¼ í´ë¦­í•˜ì—¬ ë¹›ì„ ë†“ìœ¼ì„¸ìš”.",
    status_error_load: "ë¹›ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.",
    status_error_save: "ì €ì¥ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.",
    status_export: "ì´ë¯¸ì§€ ìƒì„± ì¤‘â€¦",
    status_done: "ì™„ë£Œ."
  },

  vi: {
    world: "Cháº¿ Ä‘á»™ xem tháº¿ giá»›i",
    card: "Táº¡o báº£n Ä‘á»“",
    hint: "Nháº¥p vÃ o báº£n Ä‘á»“ Ä‘á»ƒ Ä‘áº·t hoáº·c di chuyá»ƒn Ã¡nh sÃ¡ng.",
    status_set: "Ãnh sÃ¡ng cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c Ä‘áº·t.",
    status_empty: "Nháº¥p vÃ o báº£n Ä‘á»“ Ä‘á»ƒ Ä‘áº·t Ã¡nh sÃ¡ng.",
    status_error_load: "KhÃ´ng thá»ƒ táº£i Ã¡nh sÃ¡ng.",
    status_error_save: "LÆ°u tháº¥t báº¡i.",
    status_export: "Äang táº¡o hÃ¬nh áº£nhâ€¦",
    status_done: "HoÃ n táº¥t."
  },

  tr: {
    world: "DÃ¼nya gÃ¶rÃ¼nÃ¼mÃ¼",
    card: "Harita oluÅŸtur",
    hint: "IÅŸÄ±ÄŸÄ±nÄ±zÄ± yerleÅŸtirmek veya taÅŸÄ±mak iÃ§in haritaya tÄ±klayÄ±n.",
    status_set: "IÅŸÄ±ÄŸÄ±nÄ±z yerleÅŸtirildi.",
    status_empty: "Haritaya tÄ±klayarak Ä±ÅŸÄ±ÄŸÄ±nÄ±zÄ± yerleÅŸtirin.",
    status_error_load: "IÅŸÄ±klar yÃ¼klenemedi.",
    status_error_save: "Kaydetme baÅŸarÄ±sÄ±z.",
    status_export: "GÃ¶rsel oluÅŸturuluyorâ€¦",
    status_done: "TamamlandÄ±."
  },

  sw: {
    world: "Mtazamo wa dunia",
    card: "Tengeneza ramani",
    hint: "Bofya ramani ili kuweka au kusogeza mwanga wako.",
    status_set: "Mwanga wako umewekwa.",
    status_empty: "Bofya ramani kuweka mwanga wako.",
    status_error_load: "Imeshindikana kupakia taa.",
    status_error_save: "Kuhifadhi kumeshindikana.",
    status_export: "Inaunda pichaâ€¦",
    status_done: "Imekamilika."
  },

  id: {
    world: "Tampilan dunia",
    card: "Buat peta",
    hint: "Klik peta untuk menempatkan atau memindahkan cahaya Anda.",
    status_set: "Cahaya Anda telah ditempatkan.",
    status_empty: "Klik peta untuk menempatkan cahaya Anda.",
    status_error_load: "Tidak dapat memuat cahaya.",
    status_error_save: "Gagal menyimpan.",
    status_export: "Membuat gambarâ€¦",
    status_done: "Selesai."
  }
};

  const UI_TEXT = UI[LANG] || UI.en;

const tpTexts = TP[LANG] || TP.en;

// Optional: set <html lang="..."> for accessibility
document.documentElement.lang = LANG;

const SHARE_MAIN_LABEL = {
  de: "Teilen",
  en: "Share",
  fr: "Partager",
  es: "Compartir",
  pt: "Compartilhar",
  ru: "ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ",
  ar: "Ù…Ø´Ø§Ø±ÙƒØ©",
  hi: "à¤¸à¤¾à¤à¤¾ à¤•à¤°à¥‡à¤‚",
  bn: "à¦¶à§‡à¦¯à¦¼à¦¾à¦° à¦•à¦°à§à¦¨",
  ur: "Ø´ÛŒØ¦Ø± Ú©Ø±ÛŒÚº",
  zh: "åˆ†äº«",
  ja: "å…±æœ‰",
  ko: "ê³µìœ ",
  vi: "Chia sáº»",
  tr: "PaylaÅŸ",
  sw: "Shiriki",
  id: "Bagikan"
};

document.querySelector("#shareMain .label").textContent =
  SHARE_MAIN_LABEL[LANG] || SHARE_MAIN_LABEL.en;
  
  const SHARE_LABELS = {
  de: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Link kopieren",
    native: "teilen"
  },
  en: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Copy link",
    native: "Share"
  },
  fr: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Copier le lien", 
    native: "Partager"
  },
  es: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Copiar enlace", 
    native: "Compartir"
  },
  pt: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Copiar link", 
    native: "Compartilhar"
  },
  ru: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Ğ¡ĞºĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ ÑÑÑ‹Ğ»ĞºÑƒ",
    native: "ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ"
  },
  ar: {
    whatsapp: "ÙˆØ§ØªØ³Ø§Ø¨",
    signal: "Ø³ÙŠØºÙ†Ø§Ù„",
    telegram: "ØªÙŠÙ„ÙŠØºØ±Ø§Ù…",
    facebook: "ÙÙŠØ³Ø¨ÙˆÙƒ",
    copy: "Ù†Ø³Ø® Ø§Ù„Ø±Ø§Ø¨Ø·", 
    native: "Ù…Ø´Ø§Ø±ÙƒØ©"
  },
  hi: {
    whatsapp: "à¤µà¥à¤¹à¤¾à¤Ÿà¥à¤¸à¤à¤ª",
    signal: "à¤¸à¤¿à¤—à¥à¤¨à¤²",
    telegram: "à¤Ÿà¥‡à¤²à¥€à¤—à¥à¤°à¤¾à¤®",
    facebook: "à¤«à¤¼à¥‡à¤¸à¤¬à¥à¤•",
    copy: "à¤²à¤¿à¤‚à¤• à¤•à¥‰à¤ªà¥€ à¤•à¤°à¥‡à¤‚", 
    native: "à¤¸à¤¾à¤à¤¾ à¤•à¤°à¥‡à¤‚"
  },
  bn: {
    whatsapp: "à¦¹à§‹à¦¯à¦¼à¦¾à¦Ÿà¦¸à¦…à§à¦¯à¦¾à¦ª",
    signal: "à¦¸à¦¿à¦—à¦¨à§à¦¯à¦¾à¦²",
    telegram: "à¦Ÿà§‡à¦²à¦¿à¦—à§à¦°à¦¾à¦®",
    facebook: "à¦«à§‡à¦¸à¦¬à§à¦•",
    copy: "à¦²à¦¿à¦‚à¦• à¦•à¦ªà¦¿ à¦•à¦°à§à¦¨", 
    native: "à¦¶à§‡à¦¯à¦¼à¦¾à¦° à¦•à¦°à§à¦¨"
  },
  ur: {
    whatsapp: "ÙˆØ§Ù¹Ø³ Ø§ÛŒÙ¾",
    signal: "Ø³Ú¯Ù†Ù„",
    telegram: "Ù¹ÛŒÙ„ÛŒÚ¯Ø±Ø§Ù…",
    facebook: "ÙÛŒØ³ Ø¨Ú©",
    copy: "Ù„Ù†Ú© Ú©Ø§Ù¾ÛŒ Ú©Ø±ÛŒÚº", 
    native: "Ø´ÛŒØ¦Ø± Ú©Ø±ÛŒÚº"
  },
  zh: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "å¤åˆ¶é“¾æ¥", 
    native: "åˆ†äº«"
  },
  ja: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "ãƒªãƒ³ã‚¯ã‚’ã‚³ãƒ”ãƒ¼", 
    native: "å…±æœ‰"
  },
  ko: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "ë§í¬ ë³µì‚¬", 
    native: "ê³µìœ "
  },
  vi: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Sao chÃ©p liÃªn káº¿t", 
    native: "Chia sáº»"
  },
  tr: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "BaÄŸlantÄ±yÄ± kopyala", 
    native: "PaylaÅŸ"
  },
  sw: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Nakili kiungo", 
    native: "Shiriki"
  },
  id: {
    whatsapp: "WhatsApp",
    signal: "Signal",
    telegram: "Telegram",
    facebook: "Facebook",
    copy: "Salin tautan", 
    native: "Bagikan"
  }
};
  
  const SHARE_TEXT = {
  de: "Eine stille Seite. Man setzt ein Licht und sieht, dass viele dasselbe fÃ¼hlen.",
  en: "A quiet place. You set a light and see that many feel the same.",
  es: "Un lugar tranquilo. Pones una luz y ves que muchos sienten lo mismo.",
  fr: "Un endroit calme. On y place une lumiÃ¨re et on voit que beaucoup ressentent la mÃªme chose.",
  pt: "Um lugar tranquilo. VocÃª coloca uma luz e vÃª que muitos sentem o mesmo.",
  ru: "Ğ¢Ğ¸Ñ…Ğ¾Ğµ Ğ¼ĞµÑÑ‚Ğ¾. Ğ¢Ñ‹ Ğ·Ğ°Ğ¶Ğ¸Ğ³Ğ°ĞµÑˆÑŒ ÑĞ²ĞµÑ‚ Ğ¸ Ğ²Ğ¸Ğ´Ğ¸ÑˆÑŒ, Ñ‡Ñ‚Ğ¾ Ğ¼Ğ½Ğ¾Ğ³Ğ¸Ğµ Ñ‡ÑƒĞ²ÑÑ‚Ğ²ÑƒÑÑ‚ Ñ‚Ğ¾ Ğ¶Ğµ ÑĞ°Ğ¼Ğ¾Ğµ.",
  ar: "Ù…ÙƒØ§Ù† Ù‡Ø§Ø¯Ø¦. ØªØ¶Ø¹ Ù†ÙˆØ±Ù‹Ø§ ÙˆØªØ±Ù‰ Ø£Ù† ÙƒØ«ÙŠØ±ÙŠÙ† ÙŠØ´Ø¹Ø±ÙˆÙ† Ø¨Ø§Ù„Ø´ÙŠØ¡ Ù†ÙØ³Ù‡.",
  hi: "à¤à¤• à¤¶à¤¾à¤‚à¤¤ à¤œà¤—à¤¹à¥¤ à¤†à¤ª à¤à¤• à¤°à¥‹à¤¶à¤¨à¥€ à¤°à¤–à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤”à¤° à¤¦à¥‡à¤–à¤¤à¥‡ à¤¹à¥ˆà¤‚ à¤•à¤¿ à¤¬à¤¹à¥à¤¤ à¤¸à¥‡ à¤²à¥‹à¤— à¤µà¤¹à¥€ à¤®à¤¹à¤¸à¥‚à¤¸ à¤•à¤°à¤¤à¥‡ à¤¹à¥ˆà¤‚à¥¤",
  bn: "à¦à¦•à¦Ÿà¦¿ à¦¶à¦¾à¦¨à§à¦¤ à¦œà¦¾à¦¯à¦¼à¦—à¦¾à¥¤ à¦¤à§à¦®à¦¿ à¦à¦•à¦Ÿà¦¿ à¦†à¦²à§‹ à¦¬à¦¸à¦¾à¦“ à¦à¦¬à¦‚ à¦¦à§‡à¦–à§‹ à¦¯à§‡ à¦…à¦¨à§‡à¦•à§‡à¦‡ à¦à¦•à¦‡ à¦…à¦¨à§à¦­à¦¬ à¦•à¦°à§‡à¥¤",
  ur: "Ø§ÛŒÚ© Ø®Ø§Ù…ÙˆØ´ Ø¬Ú¯ÛÛ” Ø¢Ù¾ Ø§ÛŒÚ© Ø±ÙˆØ´Ù†ÛŒ Ø±Ú©Ú¾ØªÛ’ ÛÛŒÚº Ø§ÙˆØ± Ø¯ÛŒÚ©Ú¾ØªÛ’ ÛÛŒÚº Ú©Û Ø¨ÛØª Ø³Û’ Ù„ÙˆÚ¯ ÙˆÛÛŒ Ù…Ø­Ø³ÙˆØ³ Ú©Ø±ØªÛ’ ÛÛŒÚºÛ”",
  zh: "ä¸€ä¸ªå®‰é™çš„åœ°æ–¹ã€‚ä½ ç‚¹äº®ä¸€ç›ç¯ï¼Œçœ‹åˆ°è®¸å¤šäººæœ‰ç€ç›¸åŒçš„æ„Ÿå—ã€‚",
  ja: "é™ã‹ãªå ´æ‰€ã€‚å…‰ã‚’ç½®ãã¨ã€åŒã˜ã‚ˆã†ã«æ„Ÿã˜ã¦ã„ã‚‹äººãŒãŸãã•ã‚“ã„ã‚‹ã“ã¨ãŒã‚ã‹ã‚Šã¾ã™ã€‚",
  ko: "ì¡°ìš©í•œ ê³µê°„. ë¹›ì„ ë†“ìœ¼ë©´ ë§ì€ ì‚¬ëŒë“¤ì´ ê°™ì€ ê°ì •ì„ ëŠë¼ê³  ìˆìŒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
  vi: "Má»™t nÆ¡i yÃªn tÄ©nh. Báº¡n Ä‘áº·t má»™t Ã¡nh sÃ¡ng vÃ  tháº¥y ráº±ng nhiá»u ngÆ°á»i cÅ©ng cáº£m nháº­n nhÆ° váº­y.",
  tr: "Sessiz bir yer. Bir Ä±ÅŸÄ±k bÄ±rakÄ±rsÄ±n ve birÃ§ok kiÅŸinin aynÄ± ÅŸeyi hissettiÄŸini gÃ¶rÃ¼rsÃ¼n.",
  sw: "Mahali tulivu. Unaweka mwanga na kuona kwamba wengi wanahisi vivyo hivyo.",
  id: "Tempat yang tenang. Kamu menempatkan sebuah cahaya dan melihat bahwa banyak yang merasakan hal yang sama."
};
  const SHARE_URL = location.origin + "/?lang=" + LANG;

 const text = SHARE_TEXT[LANG] || SHARE_TEXT.en;
const url  = location.origin + "/?lang=" + LANG;

  document.getElementById("shareMain").addEventListener("click", async () => {
  const text = SHARE_TEXT[LANG] || SHARE_TEXT.en;
  const url  = location.origin + "/?lang=" + LANG;

  // 1) Native Share (iOS, Android, moderne Browser)
  if (navigator.share) {
    try {
      await navigator.share({
        title: "Together We Are One",
        text: text,
        url: url
      });
      return;
    } catch (e) {
      // User cancelled â†’ silently ignore
      return;
    }
  }

  // 2) Fallback: einfaches Auswahl-MenÃ¼
  openShareModal(text, url);
});

  function openShareModal(text, url) {
  const payload = encodeURIComponent(text + "\n" + url);

  const options = [
    { label: "WhatsApp", action: () => window.open(`https://wa.me/?text=${payload}`) },
    { label: "Signal", action: () => window.open(`https://signal.me/#text=${payload}`) },
    { label: "Telegram", action: () => window.open(`https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`) },
    { label: "Facebook", action: () => window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`) },
    { label: "Link kopieren", action: () => navigator.clipboard.writeText(url) }
  ];

  // hier: sehr simples Prompt (oder eigenes Modal)
  const choice = prompt(
    options.map((o, i) => `${i + 1}: ${o.label}`).join("\n")
  );

  const idx = parseInt(choice, 10) - 1;
  if (options[idx]) options[idx].action();
}

document.querySelectorAll(".share-btn").forEach(btn => {
  btn.addEventListener("click", async () => {
    const type = btn.dataset.share;
    const text = SHARE_TEXT[LANG] || SHARE_TEXT.en;
    const url  = location.origin + "/?lang=" + LANG;

    // 1) iOS / Native Share Sheet
    if (type === "native" && navigator.share) {
      try {
        await navigator.share({
          title: "Together We Are One",
          text: text,
          url: url
        });
      } catch (err) {
        // User cancelled â€“ silently ignore
      }
      return;
    }

    // 2) Fallbacks (bestehende Buttons)
    const payload = encodeURIComponent(text + "\n" + url);

    if (type === "whatsapp") {
      window.open(`https://wa.me/?text=${payload}`, "_blank");
    }
    if (type === "signal") {
      window.open(`https://signal.me/#text=${payload}`, "_blank");
    }
    if (type === "telegram") {
      window.open(
        `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(text)}`,
        "_blank"
      );
    }
    if (type === "facebook") {
      window.open(
        `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`,
        "_blank"
      );
    }
    if (type === "copy") {
      navigator.clipboard.writeText(url);
      alert(
        LANG === "de" ? "Link kopiert"
        : LANG === "fr" ? "Lien copiÃ©"
        : LANG === "es" ? "Enlace copiado"
        : "Link copied"
      );
    }
  });
});

//const WORD_MS = 240;
  const WORD_MS = {
  zh: 120,
  ja: 130,
  ko: 140
}[LANG] || 240;
const SENTENCE_PAUSE = 900;

let tpIndex = 0, tpWordIdx = 0, tpTimer = null;
const tpTextEl = document.getElementById("tp-text");
const tpBarEl  = document.getElementById("tp-bar");

function renderSentence(sentence){
  const tokens = sentence.split(/(\s+)/);
  tpTextEl.innerHTML = tokens.map(t => {
    if (/^\s+$/.test(t)) return `<span class="tp-space">${t}</span>`;
    return `<span class="tp-word">${t}</span>`;
  }).join("");
}
function markProgress(activeWordIdx){
  const wordSpans = Array.from(tpTextEl.querySelectorAll(".tp-word"));
  wordSpans.forEach((w, i) => {
    w.classList.remove("active");
    if (i <= activeWordIdx) w.classList.add("done");
    else w.classList.remove("done");
  });
  if (wordSpans[activeWordIdx]) wordSpans[activeWordIdx].classList.add("active");
}
function updateProgress(){
  tpBarEl.style.width = `${100 * (tpIndex + 1) / tpTexts.length}%`;
}
function playSentence(idx, auto=true){
  clearInterval(tpTimer);
  tpIndex = idx; tpWordIdx = 0;
  renderSentence(tpTexts[tpIndex]);
  updateProgress();

  const isCharBased = CHAR_BASED_LANGS.includes(LANG);

const units = isCharBased
  ? Array.from(tpTexts[tpIndex])   // einzelne Zeichen
  : tpTexts[tpIndex].split(/\s+/).filter(Boolean);
 markProgress(0);

tpTimer = setInterval(() => {
  tpWordIdx++;
  if (tpWordIdx < units.length) markProgress(tpWordIdx);
  else {
    clearInterval(tpTimer);
    markProgress(units.length - 1);
    if(auto){
      setTimeout(() => {
        if(tpIndex < tpTexts.length - 1) playSentence(tpIndex + 1, true);
      }, SENTENCE_PAUSE);
    }
  }
}, WORD_MS);
}
document.getElementById("tp-prev").addEventListener("click", () => {
  if (tpIndex > 0) playSentence(tpIndex - 1, false);
});

document.getElementById("tp-next").addEventListener("click", () => {
  if (tpIndex < tpTexts.length - 1) playSentence(tpIndex + 1, false);
});
document.getElementById("tp-prev").title =
document.getElementById("tp-prev").ariaLabel =
document.getElementById("tp-prev").textContent = "â†";

document.getElementById("tp-next").title =
document.getElementById("tp-next").ariaLabel =
document.getElementById("tp-next").textContent = "â†’";

document.getElementById("btnWorld").textContent = UI_TEXT.world;
document.getElementById("btnCard").textContent = UI_TEXT.card;
document.getElementById("hint").textContent = UI_TEXT.hint;
playSentence(0, true);

/* -------------------------
   2) SUPABASE
-------------------------- */
function uuidv4() {
  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
    var r = Math.random() * 16 | 0, v = c === 'x' ? r : (r & 0x3 | 0x8);
    return v.toString(16);
  });
}

const SUPABASE_URL = 'https://gwfqdukbcgtcefqtgnbl.supabase.co';  // <-- DEIN Project URL
const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd3ZnFkdWtiY2d0Y2VmcXRnbmJsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3MDU2MTMsImV4cCI6MjA4NDI4MTYxM30.ePyuDxhVoc1ol5lQ8JbRKaybgpEPozBR3Wf71oFj040';  // <-- DEIN anon public key

const statusEl = document.getElementById("status");
function setStatus(msg){ statusEl.textContent = msg || ""; }
function setStatus(key){ statusEl.textContent = UI_TEXT[key] || ""; }

const sb = window.supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

let session = localStorage.getItem('myLightSession');
if(!session) { session = uuidv4(); localStorage.setItem('myLightSession', session); }

/* -------------------------
   3) MAP (WICHTIG: zuerst map initialisieren!)
-------------------------- */
const WORLD_BOUNDS = L.latLngBounds(L.latLng(-60, -180), L.latLng(85, 180));
const WORLD_VIEW = { center: [20, 0], zoom: 2.0 };

const map = L.map('map', {
  zoomControl: true,
  preferCanvas: true,
  worldCopyJump: false,
  zoomSnap: 0.25,
  zoomDelta: 0.25,
  maxBounds: WORLD_BOUNDS,
  maxBoundsViscosity: 1.0
}).setView(WORLD_VIEW.center, WORLD_VIEW.zoom);

/* Tile layers (mit/ohne Labels) */
const tileUrlLabels   = 'https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png';
const tileUrlNoLabels = 'https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png';
// Alternative heller: 'https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}{r}.png';

const baseWithLabels = L.tileLayer(tileUrlLabels, {
  attribution: '&copy; OpenStreetMap &copy; CARTO',
  maxZoom: 18,
  noWrap: true,
  bounds: WORLD_BOUNDS,
  crossOrigin: true
}).addTo(map);

const baseNoLabels = L.tileLayer(tileUrlNoLabels, {
  attribution: '&copy; OpenStreetMap &copy; CARTO',
  maxZoom: 18,
  noWrap: true,
  bounds: WORLD_BOUNDS,
  crossOrigin: true
});

/* Lights layer */
const canvasRenderer = L.canvas({ padding: 0.5 });
const lightsLayer = L.layerGroup().addTo(map);

// Ghost-Light: folgt dem Cursor, zeigt "hier wird das Licht gesetzt"
const ghost = L.circleMarker([0,0], {
  renderer: canvasRenderer,
  radius: 10,
  stroke: false,
  fill: true,
  fillOpacity: 0.06, /*0.10*/
  fillColor: "rgba(255,240,220,1)",/*fillColor: "rgba(255,220,170,1)"*/
  interactive: false
}).addTo(map);

const ghostCore = L.circleMarker([0,0], {
  renderer: canvasRenderer,
  radius: 2.2,
  stroke: false,
  fill: true,
  fillOpacity: 0.75,
  fillColor: "rgba(255,250,245,1)",
  interactive: false
}).addTo(map);

// nur anzeigen, wenn Maus Ã¼ber der Karte ist
map.on("mouseover", () => {
  ghost.setStyle({ fillOpacity: 0.10 });
  ghostCore.setStyle({ fillOpacity: 0.75 });
});
map.on("mouseout", () => {
  ghost.setStyle({ fillOpacity: 0.0 });
  ghostCore.setStyle({ fillOpacity: 0.0 });
});

// Cursor-Bewegung
map.on("mousemove", (e) => {
  ghost.setLatLng(e.latlng);
  ghostCore.setLatLng(e.latlng);
});
  
/* sehr kleine Punkte fÃ¼r andere */
function addLight(latlng, isMine=false){
  if(!isMine){
    L.circleMarker(latlng, {
      renderer: canvasRenderer,
      radius: 1.35,
      stroke: false,
      fill: true,
      fillOpacity: 0.70,
      fillColor: "rgba(255,250,245,1)",
      interactive: false
    }).addTo(lightsLayer);
    return;
  }
  // mein Punkt minimal grÃ¶ÃŸer
  L.circleMarker(latlng, {
    renderer: canvasRenderer,
    radius: 2.6,
    stroke: false,
    fill: true,
    fillOpacity: 0.95,
    fillColor: "rgba(255,250,245,1)",
    interactive: true
  }).addTo(lightsLayer);
}

let allLightPoints = [];

/* Load */
async function loadLights(){
  try{
    const b = map.getBounds();
    const { data, error } = await sb
      .from('lights')
      .select('lat,lng,session') // nicht unbedingt *
      .gte('lat', b.getSouth())
      .lte('lat', b.getNorth())
      .gte('lng', b.getWest())
      .lte('lng', b.getEast());

    if(error) throw error;

    allLightPoints = data || [];
    lightsLayer.clearLayers();

    let mine = null;
    for(const row of allLightPoints){
      const isMine = (row.session === session);
      if(isMine) mine = row;
      addLight([row.lat, row.lng], isMine);
    }
    setStatus(mine ? "status_set" : "status_empty");
  } catch(e){
    console.error(e);
    setStatus("status_error_load");
  }
}

async function loadMyLight(){
  const { data } = await sb.from('lights').select('*').eq('session', session).maybeSingle();
  return data;
}

/* Click: speichern, Zoom bleibt */
map.on('click', async (e) => {
  try{
    const existing = await loadMyLight();
    if(existing){
      await sb.from('lights').update({ lat: e.latlng.lat, lng: e.latlng.lng }).eq('session', session);
    } else {
      await sb.from('lights').insert({ lat: e.latlng.lat, lng: e.latlng.lng, session });
    }
    await loadLights();
  } catch(err){
    console.error(err);
    setStatus("status_error_save");
  }
});

/* Weltansicht Button */
document.getElementById("btnWorld").addEventListener("click", () => {
  map.fitBounds(WORLD_BOUNDS, {
  padding: [20, 20],
  animate: false
});
});

/* Export: Screenshot der Weltansicht, kurz ohne Labels */
function waitTiles(layer){
  return new Promise(resolve => {
    let done = false;
    const finish = () => {
      if(done) return;
      done = true;
      requestAnimationFrame(() => requestAnimationFrame(resolve));
    };
    layer.once('load', finish);
    setTimeout(finish, 1200); // Fallback
  });
}

document.getElementById("btnCard").addEventListener("click", async () => {
  try{
    setStatus("status_export");

    // 1) auf Weltansicht
    map.setView(WORLD_VIEW.center, WORLD_VIEW.zoom, { animate: true });

    // 2) no-labels Layer rein
    if(map.hasLayer(baseWithLabels)) map.removeLayer(baseWithLabels);
    baseNoLabels.addTo(map);

    // 3) warten bis Tiles geladen
    await waitTiles(baseNoLabels);

    // 4) Screenshot
    leafletImage(map, function(err, canvas){
      // 5) Layer zurÃ¼ck
      map.removeLayer(baseNoLabels);
      baseWithLabels.addTo(map);

      if(err){
        console.error(err);
        setStatus("status_error_save");
        alert("status_error_save");
        return;
      }
      const png = canvas.toDataURL("image/png");
      const a = document.createElement("a");
      a.href = png;
      a.download = "weltansicht-ohne-labels.png";
      a.click();
      setStatus("status_done");
    });
  } catch(e){
    console.error(e);
    setStatus("status_error_save");
    alert("status_error_save");
  }
});


/* Start */
loadLights();
setInterval(loadLights, 30000);
</script>
</body>
</html>
